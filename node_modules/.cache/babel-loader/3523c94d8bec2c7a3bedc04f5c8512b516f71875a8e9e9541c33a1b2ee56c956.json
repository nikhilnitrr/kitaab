{"ast":null,"code":"import { Response } from \"miragejs\";\nimport dayjs from \"dayjs\";\nimport jwt_decode from \"jwt-decode\";\nexport const requiresAuth = function (request) {\n  const encodedToken = request.requestHeaders.authorization;\n  const decodedToken = jwt_decode(encodedToken, process.env.REACT_APP_JWT_SECRET);\n  if (decodedToken) {\n    const user = this.db.users.findBy({\n      email: decodedToken.email\n    });\n    if (user) {\n      return user._id;\n    }\n  }\n  return new Response(401, {}, {\n    errors: [\"The token is invalid. Unauthorized access error.\"]\n  });\n};\nexport const formatDate = () => dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");","map":{"version":3,"names":["Response","dayjs","jwt_decode","requiresAuth","request","encodedToken","requestHeaders","authorization","decodedToken","process","env","REACT_APP_JWT_SECRET","user","db","users","findBy","email","_id","errors","formatDate","format"],"sources":["/Users/nichandr/NEOG/e-commerce/kitaab/src/backend/utils/authUtils.js"],"sourcesContent":["import { Response } from \"miragejs\";\r\nimport dayjs from \"dayjs\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport const requiresAuth = function (request) {\r\n  const encodedToken = request.requestHeaders.authorization;\r\n  const decodedToken = jwt_decode(\r\n    encodedToken,\r\n    process.env.REACT_APP_JWT_SECRET\r\n  );\r\n  if (decodedToken) {\r\n    const user = this.db.users.findBy({ email: decodedToken.email });\r\n    if (user) {\r\n      return user._id;\r\n    }\r\n  }\r\n  return new Response(\r\n    401,\r\n    {},\r\n    { errors: [\"The token is invalid. Unauthorized access error.\"] }\r\n  );\r\n};\r\n\r\nexport const formatDate = () => dayjs().format(\"YYYY-MM-DDTHH:mm:ssZ\");\r\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,UAAU;AACnC,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,UAAU,MAAM,YAAY;AAEnC,OAAO,MAAMC,YAAY,GAAG,SAAAA,CAAUC,OAAO,EAAE;EAC7C,MAAMC,YAAY,GAAGD,OAAO,CAACE,cAAc,CAACC,aAAa;EACzD,MAAMC,YAAY,GAAGN,UAAU,CAC7BG,YAAY,EACZI,OAAO,CAACC,GAAG,CAACC,oBACd,CAAC;EACD,IAAIH,YAAY,EAAE;IAChB,MAAMI,IAAI,GAAG,IAAI,CAACC,EAAE,CAACC,KAAK,CAACC,MAAM,CAAC;MAAEC,KAAK,EAAER,YAAY,CAACQ;IAAM,CAAC,CAAC;IAChE,IAAIJ,IAAI,EAAE;MACR,OAAOA,IAAI,CAACK,GAAG;IACjB;EACF;EACA,OAAO,IAAIjB,QAAQ,CACjB,GAAG,EACH,CAAC,CAAC,EACF;IAAEkB,MAAM,EAAE,CAAC,kDAAkD;EAAE,CACjE,CAAC;AACH,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGA,CAAA,KAAMlB,KAAK,CAAC,CAAC,CAACmB,MAAM,CAAC,sBAAsB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}